import numpy as np
from copy import deepcopy 

from model_family_configs import ModelConfig

scaling_law_family = {
    '50M': ModelConfig(
        wandb_run_name='hkm-50M',
        n_embd=512,
        n_layer=12,
        n_head=4,
        n_kv_head=4,
        prod_sbatch_nodes=1, 
        prod_n_gpus=2, 
        prod_gradient_accumulation_steps=2, 
        prod_batch_size=2, 
        prod_max_iters=1252, 
        prod_sbatch_mem=256,
    ),
    '100M': ModelConfig(
        wandb_run_name='hkm-100M',
        n_embd=768,
        n_layer=12,
        n_head=6,
        n_kv_head=3,
        prod_sbatch_nodes=1, 
        prod_n_gpus=2, 
        prod_gradient_accumulation_steps=2, 
        prod_batch_size=2, 
        prod_max_iters=1252, 
        prod_sbatch_mem=256,
    ),
    '250M': ModelConfig(
        wandb_run_name='hkm-250M',
        n_embd=1024,
        n_layer=16,
        n_head=8,
        n_kv_head=4,
        prod_sbatch_nodes=1, 
        prod_n_gpus=2, 
        prod_gradient_accumulation_steps=2, 
        prod_batch_size=2, 
        prod_max_iters=1252, 
        prod_sbatch_mem=256,
    ),
    '500M': ModelConfig(
        wandb_run_name='hkm-500M',
        n_embd=1536,
        n_layer=16,
        n_head=12,
        n_kv_head=4,
        prod_sbatch_nodes=1, 
        prod_n_gpus=2, 
        prod_gradient_accumulation_steps=2, 
        prod_batch_size=2, 
        prod_max_iters=1252, 
        prod_sbatch_mem=256,
        enable_fsdp=True,
    ),
    '1B': ModelConfig(
        wandb_run_name='hkm-1B',
        n_embd=2048,
        n_layer=20,
        n_head=16,
        n_kv_head=8,
        prod_sbatch_nodes=1,
        prod_n_gpus=4,
        prod_gradient_accumulation_steps=2,
        prod_batch_size=2,
        prod_max_iters=1252,
        prod_sbatch_mem=256,
        enable_fsdp=True,
    ),
    '3B': ModelConfig(
        wandb_run_name='hkm-3B',
        n_embd=3072,
        n_layer=24,
        n_head=24,
        n_kv_head=8,
        prod_sbatch_nodes=1,
        prod_n_gpus=8,
        prod_gradient_accumulation_steps=8,
        prod_batch_size=2,
        prod_max_iters=1252,
        prod_sbatch_mem=256,
        enable_fsdp=True,
    ),
    '7B': ModelConfig(
        wandb_run_name='hkm-7B',
        n_embd=4096,
        n_layer=32,
        n_head=32,
        n_kv_head=8,
        prod_sbatch_nodes=1,
        prod_n_gpus=8,
        prod_gradient_accumulation_steps=8,
        prod_batch_size=2,
        prod_max_iters=1252,
        prod_sbatch_mem=256,
        enable_fsdp=True,
    ),
}